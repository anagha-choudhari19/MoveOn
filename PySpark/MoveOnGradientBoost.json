{"paragraphs":[{"text":"%md\n# MoveON\n### Pace it up!","user":"anonymous","dateUpdated":"2022-04-11T22:25:11+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>MoveON</h1>\n<h3>Pace it up!</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1646327171216_-730643378","id":"20220214-161315_79185713","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:25:14+0530","dateFinished":"2022-04-11T22:25:22+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:172"},{"text":"%pyspark\n#file_path=\"/user/talentum/Kinematics_Data.csv\"\n#mon_df = spark.read.csv(file_path, header=True, inferSchema=True)\n\nquery = '''SELECT * FROM moveon.kinematics'''\n\n# Assign the result of Spark's query to people_df_names\nmon_df = spark.sql(query)\nmon_df = mon_df.dropna()\n","user":"anonymous","dateUpdated":"2022-04-11T22:25:22+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646327171235_-2046867768","id":"20220214-113343_1940572877","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:25:23+0530","dateFinished":"2022-04-11T22:27:12+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:173"},{"text":"%md\nDate and time extraction\n","user":"anonymous","dateUpdated":"2022-04-11T22:27:12+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Date and time extraction</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1646327171242_-569229696","id":"20220219-153600_767796865","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:13+0530","dateFinished":"2022-04-11T22:27:14+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174"},{"text":"%md\n\n- In username column we have only one unique value = 'viktor' hence we drop that column\n- Moreover there is no use of date and time column hence we drop those columns too","user":"anonymous","dateUpdated":"2022-04-11T22:27:14+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<ul>\n  <li>In username column we have only one unique value = &lsquo;viktor&rsquo; hence we drop that column</li>\n  <li>Moreover there is no use of date and time column hence we drop those columns too</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1646327171247_-1362660108","id":"20220214-153330_393672639","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:15+0530","dateFinished":"2022-04-11T22:27:15+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:175"},{"text":"%pyspark\ncols = (\"username\",\"c_date\",\"c_time\")\n\nmon_df=mon_df.drop(*cols)\nprint(mon_df.show(10))\n","user":"anonymous","dateUpdated":"2022-04-11T22:27:15+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+--------+------+-------+-------+-------+-------+-------+\n|wrist|activity| acc_x|  acc_y|  acc_z| gyro_x| gyro_y| gyro_z|\n+-----+--------+------+-------+-------+-------+-------+-------+\n|    0|       0| 0.265|-0.7814|-0.0076| -0.059| 0.0325|-2.9296|\n|    0|       0|0.6722|-1.1233|-0.2344|-0.1757| 0.0208| 0.1269|\n|    0|       0|0.4399|-1.4817| 0.0722|-0.9105| 0.1063|-2.4367|\n|    0|       0|0.3031|-0.8125| 0.0888| 0.1199|-0.4099|-2.9336|\n|    0|       0|0.4814|-0.9312| 0.0359| 0.0527| 0.4379| 2.4922|\n|    0|       0|0.4044|-0.8056|-0.0956| 0.6925|-0.2179|  2.575|\n|    0|       0| 0.632| -1.129|-0.2982| 0.0548|-0.1896| 0.4473|\n|    0|       0| 0.667|-1.3503| -0.088|-0.8094|-0.7938|-1.4348|\n|    0|       0|0.2704|-0.8633| 0.1293|-0.4173|-0.1904|-2.6759|\n|    0|       0| 0.469| -1.074| 0.0219| 0.0388| 1.1491| 1.6982|\n+-----+--------+------+-------+-------+-------+-------+-------+\nonly showing top 10 rows\n\nNone\n"}]},"apps":[],"jobName":"paragraph_1646327171249_-382439694","id":"20220214-153536_1596408506","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:16+0530","dateFinished":"2022-04-11T22:27:23+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:176"},{"text":"%md\nMerging Features","user":"anonymous","dateUpdated":"2022-04-11T22:27:23+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Merging Features</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1646327171257_2110039891","id":"20220221-193239_953360840","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:24+0530","dateFinished":"2022-04-11T22:27:24+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:177"},{"text":"%pyspark\n#Merging all float cols\nfrom pyspark.ml.feature import VectorAssembler\nfeatures=VectorAssembler(inputCols=['acc_x','acc_y','acc_z','gyro_x','gyro_y','gyro_z','wrist'],outputCol='Independent Features')\nmon_df=features.transform(mon_df)","user":"anonymous","dateUpdated":"2022-04-11T22:27:24+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646327171257_-1555063633","id":"20220221-105709_725120811","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:25+0530","dateFinished":"2022-04-11T22:27:27+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:178"},{"text":"%pyspark\n#Normalisation of features\nfrom pyspark.ml.feature import MinMaxScaler\nscaler=MinMaxScaler(inputCol='Independent Features', outputCol='scaledFeatures')\nscalardata=scaler.fit(mon_df)\nout=scalardata.transform(mon_df)","user":"anonymous","dateUpdated":"2022-04-11T22:27:27+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646327171260_-72004077","id":"20220221-110925_322228563","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:28+0530","dateFinished":"2022-04-11T22:27:33+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:179"},{"text":"%pyspark\nout.show(10)","user":"anonymous","dateUpdated":"2022-04-11T22:27:33+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+--------+------+-------+-------+-------+-------+-------+--------------------+--------------------+\n|wrist|activity| acc_x|  acc_y|  acc_z| gyro_x| gyro_y| gyro_z|Independent Features|      scaledFeatures|\n+-----+--------+------+-------+-------+-------+-------+-------+--------------------+--------------------+\n|    0|       0| 0.265|-0.7814|-0.0076| -0.059| 0.0325|-2.9296|[0.26499998569488...|[0.51265314222003...|\n|    0|       0|0.6722|-1.1233|-0.2344|-0.1757| 0.0208| 0.1269|[0.67220002412796...|[0.54982745898185...|\n|    0|       0|0.4399|-1.4817| 0.0722|-0.9105| 0.1063|-2.4367|[0.43990001082420...|[0.52862020587952...|\n|    0|       0|0.3031|-0.8125| 0.0888| 0.1199|-0.4099|-2.9336|[0.30309998989105...|[0.51613138753176...|\n|    0|       0|0.4814|-0.9312| 0.0359| 0.0527| 0.4379| 2.4922|[0.48140001296997...|[0.53240884556462...|\n|    0|       0|0.4044|-0.8056|-0.0956| 0.6925|-0.2179|  2.575|[0.40439999103546...|[0.52537931969062...|\n|    0|       0| 0.632| -1.129|-0.2982| 0.0548|-0.1896| 0.4473|[0.63200002908706...|[0.54615750021852...|\n|    0|       0| 0.667|-1.3503| -0.088|-0.8094|-0.7938|-1.4348|[0.66699999570846...|[0.54935273529474...|\n|    0|       0|0.2704|-0.8633| 0.1293|-0.4173|-0.1904|-2.6759|[0.27039998769760...|[0.51314612199905...|\n|    0|       0| 0.469| -1.074| 0.0219| 0.0388| 1.1491| 1.6982|[0.46900001168251...|[0.53127681822622...|\n+-----+--------+------+-------+-------+-------+-------+-------+--------------------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646327171267_-1889122370","id":"20220221-111451_63819427","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:33+0530","dateFinished":"2022-04-11T22:27:35+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:180"},{"text":"%pyspark\n#Target column analysis\nfrom pyspark.ml.feature import StringIndexer,VectorIndexer\nfinal_data=out.select(\"scaledFeatures\",\"activity\")\nlabelIndexer=StringIndexer(inputCol=\"activity\",outputCol=\"Target\").fit(final_data)\n\nfinal_data=labelIndexer.transform(final_data)\nfinal_data=final_data.select(\"scaledFeatures\",\"Target\")\nfinal_data.show(10)","user":"anonymous","dateUpdated":"2022-04-11T22:27:35+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------+\n|      scaledFeatures|Target|\n+--------------------+------+\n|[0.51265314222003...|   1.0|\n|[0.54982745898185...|   1.0|\n|[0.52862020587952...|   1.0|\n|[0.51613138753176...|   1.0|\n|[0.53240884556462...|   1.0|\n|[0.52537931969062...|   1.0|\n|[0.54615750021852...|   1.0|\n|[0.54935273529474...|   1.0|\n|[0.51314612199905...|   1.0|\n|[0.53127681822622...|   1.0|\n+--------------------+------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646327171269_-182733674","id":"20220221-113637_1272410603","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:35+0530","dateFinished":"2022-04-11T22:27:40+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:181"},{"text":"%md\nTrain Test Split\n","user":"anonymous","dateUpdated":"2022-04-11T22:27:40+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Train Test Split</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1646327171269_2055564149","id":"20220221-193416_878155700","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:40+0530","dateFinished":"2022-04-11T22:27:40+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:182"},{"text":"%pyspark\n#Split data\n\ntrain, test = final_data.randomSplit([0.8, 0.2],seed=25)\nY_train=train.select('Target')\nX_train=train.drop('Target')\n\nY_test=test.select('Target')\nX_test=test.drop('Target')\n\n\n#X_train.show(10)\n\n\n#train,test=final_data.randomSplit([0.75,0.25],seed=25)\n#train.printSchema()","user":"anonymous","dateUpdated":"2022-04-11T22:27:40+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646327171275_983239429","id":"20220214-114952_703465108","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:41+0530","dateFinished":"2022-04-11T22:27:41+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:183"},{"text":"%pyspark\nimport pandas as pd\nX_train= X_train.select(\"*\").toPandas()\nY_train= Y_train.select(\"*\").toPandas()\nresult = pd.concat([X_train, Y_train], axis=1)\ntrain=spark.createDataFrame(result)\ntrain.show(10)","user":"anonymous","dateUpdated":"2022-04-11T22:27:41+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------+\n|      scaledFeatures|Target|\n+--------------------+------+\n|[0.0,0.7192894235...|   0.0|\n|[0.01612225676508...|   0.0|\n|[0.02277750826840...|   0.0|\n|[0.03556759022285...|   0.0|\n|[0.03956619128927...|   0.0|\n|[0.04551844993841...|   0.0|\n|[0.05059432911261...|   0.0|\n|[0.05382607637264...|   0.0|\n|[0.05779729602193...|   0.0|\n|[0.05913019206518...|   0.0|\n+--------------------+------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646327171276_-1685120285","id":"20220221-183931_764864205","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:27:42+0530","dateFinished":"2022-04-11T22:27:59+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:184"},{"text":"%md\nGradient Boosted Tree Classifier\n","user":"anonymous","dateUpdated":"2022-04-11T22:27:59+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Gradient Boosted Tree Classifier</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1646327171280_-2104697297","id":"20220221-193501_1422158987","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:28:00+0530","dateFinished":"2022-04-11T22:28:00+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:185"},{"text":"%pyspark\n#Gradient Boost\nfrom pyspark.ml.classification import GBTClassifier\n\n\ngb = GBTClassifier(featuresCol='scaledFeatures', labelCol='Target')\n\n# Fit the model\n\nGBModel = gb.fit(train)\n\n# Predictions\npredictions=GBModel.transform(X_test)\n\n\n#Time Comsuming ","user":"anonymous","dateUpdated":"2022-04-11T22:28:00+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646327171281_-440946543","id":"20220218-214500_1859832428","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:28:00+0530","dateFinished":"2022-04-11T22:28:42+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:186"},{"text":"%pyspark\npredictions.show(10)","user":"anonymous","dateUpdated":"2022-04-11T22:28:42+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+----------+\n|      scaledFeatures|       rawPrediction|         probability|prediction|\n+--------------------+--------------------+--------------------+----------+\n|[0.05463859489537...|[1.55090303752374...|[0.95696718243912...|       0.0|\n|[0.07241322659136...|[0.78781796252861...|[0.82858557030306...|       0.0|\n|[0.07279665349456...|[1.54463253285505...|[0.95644776130030...|       0.0|\n|[0.07360003036768...|[1.55090303752374...|[0.95696718243912...|       0.0|\n|[0.07642096930739...|[1.52818983598142...|[0.95505715742471...|       0.0|\n|[0.09695267899088...|[1.54083480291308...|[0.95613026987329...|       0.0|\n|[0.10145337427863...|[1.51963999740476...|[0.95431745038390...|       0.0|\n|[0.10288669787248...|[1.54083480291308...|[0.95613026987329...|       0.0|\n|[0.10462121705480...|[1.55090303752374...|[0.95696718243912...|       0.0|\n|[0.10466688177113...|[1.19609109619946...|[0.91622921065042...|       0.0|\n+--------------------+--------------------+--------------------+----------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646327171285_-711589092","id":"20220221-190330_1626240476","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:28:42+0530","dateFinished":"2022-04-11T22:28:46+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:187"},{"text":"%pyspark\nimport pandas as pd\nY_test= Y_test.select(\"*\").toPandas()\npredictions= predictions.select(\"*\").toPandas()\nresult = pd.concat([Y_test, predictions], axis=1)\ntest=spark.createDataFrame(result)\ntest.show(10)","user":"anonymous","dateUpdated":"2022-04-11T22:28:46+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------------------+--------------------+--------------------+----------+\n|Target|      scaledFeatures|       rawPrediction|         probability|prediction|\n+------+--------------------+--------------------+--------------------+----------+\n|   0.0|[0.05463859489537...|[1.55090303752374...|[0.95696718243912...|       0.0|\n|   0.0|[0.07241322659136...|[0.78781796252861...|[0.82858557030306...|       0.0|\n|   0.0|[0.07279665349456...|[1.54463253285505...|[0.95644776130030...|       0.0|\n|   0.0|[0.07360003036768...|[1.55090303752374...|[0.95696718243912...|       0.0|\n|   0.0|[0.07642096930739...|[1.52818983598142...|[0.95505715742471...|       0.0|\n|   0.0|[0.09695267899088...|[1.54083480291308...|[0.95613026987329...|       0.0|\n|   0.0|[0.10145337427863...|[1.51963999740476...|[0.95431745038390...|       0.0|\n|   0.0|[0.10288669787248...|[1.54083480291308...|[0.95613026987329...|       0.0|\n|   0.0|[0.10462121705480...|[1.55090303752374...|[0.95696718243912...|       0.0|\n|   0.0|[0.10466688177113...|[1.19609109619946...|[0.91622921065042...|       0.0|\n+------+--------------------+--------------------+--------------------+----------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646327171294_982496688","id":"20220221-190747_1562193629","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:28:46+0530","dateFinished":"2022-04-11T22:28:55+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:188"},{"text":"%md\nValidation of Model","user":"anonymous","dateUpdated":"2022-04-11T22:28:55+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1646327171296_2026784724","id":"20220221-193609_186449050","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:28:55+0530","dateFinished":"2022-04-11T22:28:55+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:189"},{"text":"%pyspark\n#Acccuracy\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\nevaluator=MulticlassClassificationEvaluator(labelCol='Target',predictionCol='prediction',metricName='accuracy')\nevaluator.evaluate(test)\n","user":"anonymous","dateUpdated":"2022-04-11T22:28:55+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.9783539893768919\n"}]},"apps":[],"jobName":"paragraph_1646327171297_-56849827","id":"20220221-120849_1537678528","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:28:56+0530","dateFinished":"2022-04-11T22:28:58+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:190"},{"text":"%pyspark\nmeasures=['f1','accuracy','weightedPrecision','weightedRecall']\nfor ele in measures:\n    evaluator.setMetricName(ele)\n    print(ele,\" = \",evaluator.evaluate(test))","user":"anonymous","dateUpdated":"2022-04-11T22:28:58+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"MulticlassClassificationEvaluator_8dedb70b76b7\nf1  =  0.978351690359081\nMulticlassClassificationEvaluator_8dedb70b76b7\naccuracy  =  0.9783539893768919\nMulticlassClassificationEvaluator_8dedb70b76b7\nweightedPrecision  =  0.9784197988426784\nMulticlassClassificationEvaluator_8dedb70b76b7\nweightedRecall  =  0.9783539893768919\n"}]},"apps":[],"jobName":"paragraph_1646327171303_-692214529","id":"20220218-215455_995791974","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:28:58+0530","dateFinished":"2022-04-11T22:29:03+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:191"},{"text":"%sh\nhdfs dfs -rm -r /user/talentum/MoveOn/ModelGB\n","user":"anonymous","dateUpdated":"2022-04-11T22:29:03+0530","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"rm: `/user/talentum/MoveOn/ModelGB': No such file or directory\n"},{"type":"TEXT","data":"ExitValue: 1"}]},"apps":[],"jobName":"paragraph_1646327171307_-717861705","id":"20220302-182204_1391686117","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-04-11T22:29:03+0530","dateFinished":"2022-04-11T22:29:11+0530","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:192"},{"text":"%pyspark\nGBModel.save('/user/talentum/MoveOn/ModelGB')","user":"anonymous","dateUpdated":"2022-03-03T23:51:10+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646327171307_880854959","id":"20220302-161852_1855655043","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-03-03T23:51:11+0530","dateFinished":"2022-03-03T23:51:16+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:193"},{"text":"%pyspark\nfrom pyspark.ml.classification import GBTClassificationModel\nsgbmodel=GBTClassificationModel.load('/user/talentum/MoveOn/ModelGB')\n","user":"anonymous","dateUpdated":"2022-03-03T23:51:19+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646327171310_1020279521","id":"20220221-191748_1379323738","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-03-03T23:51:20+0530","dateFinished":"2022-03-03T23:51:23+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:194"},{"text":"%pyspark\nspredictions=sgbmodel.transform(X_test)\nspredictions.show(10)","user":"anonymous","dateUpdated":"2022-03-03T23:15:25+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+----------+\n|      scaledFeatures|       rawPrediction|         probability|prediction|\n+--------------------+--------------------+--------------------+----------+\n|[0.05463859489537...|[1.55090303752374...|[0.95696718243912...|       0.0|\n|[0.07241322659136...|[0.78781796252861...|[0.82858557030306...|       0.0|\n|[0.07279665349456...|[1.54463253285505...|[0.95644776130030...|       0.0|\n|[0.07360003036768...|[1.55090303752374...|[0.95696718243912...|       0.0|\n|[0.07642096930739...|[1.52818983598142...|[0.95505715742471...|       0.0|\n|[0.09695267899088...|[1.54083480291308...|[0.95613026987329...|       0.0|\n|[0.10145337427863...|[1.51963999740476...|[0.95431745038390...|       0.0|\n|[0.10288669787248...|[1.54083480291308...|[0.95613026987329...|       0.0|\n|[0.10462121705480...|[1.55090303752374...|[0.95696718243912...|       0.0|\n|[0.10466688177113...|[1.19609109619946...|[0.91622921065042...|       0.0|\n+--------------------+--------------------+--------------------+----------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646327171311_-855264349","id":"20220302-162053_128575232","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-03-03T23:15:25+0530","dateFinished":"2022-03-03T23:15:28+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:195"},{"text":"%sh\nhdfs dfs -rm -r /user/talentum/MoveOn/scalardata","user":"anonymous","dateUpdated":"2022-03-03T22:36:11+0530","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1646327171311_442036387","id":"20220303-170209_257129276","dateCreated":"2022-03-03T22:36:11+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:196"},{"text":"%pyspark\nscalardata.save('/user/talentum/MoveOn/scalardata')\n","user":"anonymous","dateUpdated":"2022-03-03T23:51:27+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646327171312_1120943505","id":"20220303-164153_1843266740","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-03-03T23:51:27+0530","dateFinished":"2022-03-03T23:51:28+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:197"},{"text":"%sh\nhdfs dfs -ls /user/talentum/MoveOn/scalardata\n","user":"anonymous","dateUpdated":"2022-03-03T23:51:30+0530","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 2 items\ndrwxr-xr-x   - talentum supergroup          0 2022-03-03 23:51 /user/talentum/MoveOn/scalardata/data\ndrwxr-xr-x   - talentum supergroup          0 2022-03-03 23:51 /user/talentum/MoveOn/scalardata/metadata\n"}]},"apps":[],"jobName":"paragraph_1646327171319_1668627989","id":"20220303-164115_95708572","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-03-03T23:51:31+0530","dateFinished":"2022-03-03T23:51:36+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:198"},{"text":"%pyspark\nimport pandas as pd\nfrom pyspark.ml.feature import MinMaxScalerModel\n\ndata = [(-0.0576,\t0.9426,\t-0.1372,\t-1.0585,\t0.065,\t-0.0035,0)]\ndf = pd.DataFrame(data, columns=['acc_x','acc_y','acc_z','gyro_x','gyro_y','gyro_z','wrist'])\nsdf = spark.createDataFrame(df)\n#sdf.show()\nfeatures = VectorAssembler(inputCols=['acc_x', 'acc_y', 'acc_z', 'gyro_x', 'gyro_y', 'gyro_z', 'wrist'],outputCol='Independent Features')\nmon_df = features.transform(sdf)\nprint(\"fe m 1\")\n# scaler = MinMaxScaler(inputCol='Independent Features', outputCol='scaledFeatures')\n\nscalardata= MinMaxScalerModel.load('/user/talentum/MoveOn/scalardata')\nout = scalardata.transform(mon_df)\nprint(\"fe m 2\")\nspredictions=sgbmodel.transform(out.select('scaledFeatures'))\nspredictions.show(10)","user":"anonymous","dateUpdated":"2022-03-03T23:51:35+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"fe m 1\nfe m 2\n+--------------------+--------------------+--------------------+----------+\n|      scaledFeatures|       rawPrediction|         probability|prediction|\n+--------------------+--------------------+--------------------+----------+\n|[0.48320217727974...|[1.54122276056890...|[0.95616280426215...|       0.0|\n+--------------------+--------------------+--------------------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1646327171321_1752323478","id":"20220302-162207_321556092","dateCreated":"2022-03-03T22:36:11+0530","dateStarted":"2022-03-03T23:51:35+0530","dateFinished":"2022-03-03T23:51:38+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:199"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2022-03-03T22:36:11+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1646327171325_97221769","id":"20220303-164642_481296946","dateCreated":"2022-03-03T22:36:11+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:200"}],"name":"MoveOnGradientBoost","id":"2GXHE16N9","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}